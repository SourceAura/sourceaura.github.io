---
/*
Ase: displays a "PageFind" search pill.
Always navigates Home.
Also toggles Pagefind without coupling to navigation.
*/
import { SITE } from "@consts";
---

<a
  href="/"
  aria-label="Home & Search"
  data-role="search-pill"
  class="group relative flex items-center
    overflow-hidden rounded-full
    border border-black/15
    px-3 py-1.5
    text-xs font-semibold
    transition-colors duration-300
    hover:bg-black/5
    focus-visible:bg-black/5
    dark:border-white/20
    dark:hover:bg-white/5
    dark:focus-visible:bg-white/5"
  style="background-color: transparent; text-decoration: none;"
  onclick="
    // Toggle Pagefind without interfering with navigation
    if (window.togglePagefind) {
      window.togglePagefind();
    } else if (window.openPagefind) {
      window.openPagefind();
    } else {
      window.dispatchEvent(new Event('open-pagefind'));
    }
  "
  onkeydown="
    if (event.key === 'Enter' || event.key === ' ') {
      if (window.togglePagefind) {
        window.togglePagefind();
      } else if (window.openPagefind) {
        window.openPagefind();
      } else {
        window.dispatchEvent(new Event('open-pagefind'));
      }
    }
  "
>
  <span
    class="select-none tracking-wide opacity-80 transition group-hover:opacity-100"
  >
    {SITE.ALIAS}
  </span>
</a>

<style is:global>
  /* Header reacts to search proximity (set by PageFind spring) */
  header[data-role="app-header"] {
    transform: translateY(calc(-1px * var(--search-lift, 0)));
    transition: transform 90ms linear;
  }

  header[data-role="app-header"] a[data-role="search-pill"] {
    box-shadow: 0 0 calc(10px * var(--search-proximity, 0))
      rgba(255, 255, 255, 0.18);
    transition: box-shadow 90ms linear;
  }
</style>
