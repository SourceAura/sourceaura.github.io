---
import Ase from "@components/Ase.astro";
import SysInfo from "@components/SysInfo.astro";
import Container from "@components/Container.astro";
---

<header transition:persist class="app-header py-4" data-role="app-header">
  <Container>
    <div class="flex h-full items-center justify-between">
      <Ase />
      <nav class="flex items-center gap-1 text-sm"><SysInfo /></nav>
    </div>
  </Container>
  <div class="edge-line edge-line-top" aria-hidden="true"></div>
  <style is:global>
    header[data-role="app-header"] {
      position: fixed;
      inset: 0 0 auto 0;
      z-index: 20;
      background: transparent !important;
    }
    .edge-line {
      position: absolute;
      left: 0;
      width: 100%;
      pointer-events: none;
      overflow: hidden;
    }
    .edge-line-top {
      top: 0;
      height: calc(
        1px + var(--pulse, 0.5) * 0.6px + var(--pulse-cadence, 0) * 0.35px
      );
    }
    .edge-line::before {
      content: "";
      position: absolute;
      inset: 0; /*
Slightly taller paint area so shimmer never clips */
      height: 3px;
      top: -1px;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(
          255,
          255,
          255,
          calc(
            0.32 + var(--pulse, 0.5) * 0.44 + var(--pulse-spike, 0) * 0.45 +
              var(--pulse-lunar, 0.5) * 0.1 + var(--pulse-weather, 0.12) * 0.1 +
              var(--pulse-cadence, 0) * 0.22
          )
        ),
        transparent
      );
      background-size: 100% 3px;
      background-position: 0 0;
      animation:
        edge-scan calc(2.8s - var(--pulse-decay, 0) * 1.4s) linear infinite,
        edge-breath 4.6s ease-in-out infinite,
        edge-vshimmer 6.8s ease-in-out infinite;
      animation-delay:
        0s, calc(var(--pulse-phase, 0) * -0.12s),
        calc(var(--pulse-phase, 0) * -0.18s);
    }
    html.light .edge-line::before {
      background: linear-gradient(
        90deg,
        transparent,
        rgba(
          0,
          0,
          0,
          calc(
            0.26 + var(--pulse, 0.5) * 0.4 + var(--pulse-spike, 0) * 0.38 +
              var(--pulse-lunar, 0.5) * 0.1 + var(--pulse-weather, 0.12) * 0.1 +
              var(--pulse-cadence, 0) * 0.2
          )
        ),
        transparent
      );
      background-size: 100% 3px;
    }
    @keyframes edge-scan {
      from {
        transform: translateX(-100%);
      }
      to {
        transform: translateX(100%);
      }
    }
    @keyframes edge-breath {
      0%,
      100% {
        opacity: 0.65;
      }
      50% {
        opacity: 1;
      }
    } /* Barely
perceptible vertical shimmer */
    @keyframes edge-vshimmer {
      0%,
      100% {
        background-position: 0 0;
      }
      50% {
        background-position: 0 1px;
      }
    }
    @media (prefers-reduced-motion: reduce) {
      .edge-line::before {
        animation: none;
      }
    }
  </style>
</header>
