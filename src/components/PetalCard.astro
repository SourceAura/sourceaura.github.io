---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import FormattedDate from "./FormattedDate.astro";
import { readingTime } from "@lib/utils";
import { h } from '@vue/runtime-core';
import { defineComponent } from 'vue';

interface Props {
  post: CollectionEntry<'petals'>;
}

const { post } = Astro.props;
const { title, description, image, date } = post.data;
---

<div class="petal-card group relative overflow-hidden rounded-lg shadow-lg transition-all duration-300 h-full">
  <a href={`/petals/${post.slug}`} class="block w-full h-full">
    <div 
      class="absolute inset-0 bg-cover bg-center transition-transform duration-300 group-hover:scale-110 group-active:scale-110" 
      style={`background-image: url(${image ? image.src : ''}); background-color: ${image ? 'transparent' : 'rgba(255, 255, 255, 0.1)'}; border: ${image ? 'none' : '1px solid #ccc'};`}
    >
      {!image && <span class="text-gray-500 absolute inset-0 flex items-center justify-center text-xs">No image</span>}
    </div>
    <div class="relative p-1 bg-black bg-opacity-50 text-white h-full flex flex-col justify-between transition-opacity duration-300 group-hover:bg-opacity-70 group-active:bg-opacity-70">
      <div>
        <h2 class="text-xs font-bold mb-0.5 line-clamp-1">{title}</h2>
        <p class="text-xs mb-1 line-clamp-2">{description}</p>
      </div>
      <div class="text-xs opacity-0 group-hover:opacity-100 group-active:opacity-100 transition-opacity duration-300">
        <FormattedDate date={new Date(date)} />
        <span class="mx-0.5">â€¢</span>
        <span>{readingTime(post.body)}</span>
      </div>
    </div>
  </a>
</div>

<style>
  .petal-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .petal-card:hover, .petal-card:active {
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    z-index: 10;
  }
</style>